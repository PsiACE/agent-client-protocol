{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "anyOf": [
    {
      "$ref": "#/$defs/AnyClientRequest"
    },
    {
      "$ref": "#/$defs/AnyClientResult"
    },
    {
      "$ref": "#/$defs/AnyAgentRequest"
    },
    {
      "$ref": "#/$defs/AnyAgentResult"
    }
  ],
  "$defs": {
    "AnyAgentRequest": {
      "anyOf": [
        {
          "$ref": "#/$defs/GetThreadsParams"
        },
        {
          "$ref": "#/$defs/CreateThreadParams"
        },
        {
          "$ref": "#/$defs/OpenThreadParams"
        },
        {
          "$ref": "#/$defs/GetThreadEntriesParams"
        },
        {
          "$ref": "#/$defs/SendMessageParams"
        }
      ]
    },
    "AnyAgentResult": {
      "anyOf": [
        {
          "$ref": "#/$defs/GetThreadsResponse"
        },
        {
          "$ref": "#/$defs/CreateThreadResponse"
        },
        {
          "$ref": "#/$defs/OpenThreadResponse"
        },
        {
          "$ref": "#/$defs/GetThreadEntriesResponse"
        },
        {
          "$ref": "#/$defs/SendMessageResponse"
        }
      ]
    },
    "AnyClientRequest": {
      "anyOf": [
        {
          "$ref": "#/$defs/StreamMessageChunkParams"
        },
        {
          "$ref": "#/$defs/ReadTextFileParams"
        },
        {
          "$ref": "#/$defs/ReadBinaryFileParams"
        },
        {
          "$ref": "#/$defs/StatParams"
        },
        {
          "$ref": "#/$defs/GlobSearchParams"
        },
        {
          "$ref": "#/$defs/EndTurnParams"
        }
      ]
    },
    "AnyClientResult": {
      "anyOf": [
        {
          "$ref": "#/$defs/StreamMessageChunkResponse"
        },
        {
          "$ref": "#/$defs/ReadTextFileResponse"
        },
        {
          "$ref": "#/$defs/ReadBinaryFileResponse"
        },
        {
          "$ref": "#/$defs/StatResponse"
        },
        {
          "$ref": "#/$defs/GlobSearchResponse"
        },
        {
          "$ref": "#/$defs/EndTurnResponse"
        }
      ]
    },
    "CreateThreadParams": {
      "type": "null"
    },
    "CreateThreadResponse": {
      "type": "object",
      "properties": {
        "threadId": {
          "$ref": "#/$defs/ThreadId"
        }
      },
      "required": ["threadId"]
    },
    "EndTurnParams": {
      "type": "object",
      "properties": {
        "threadId": {
          "$ref": "#/$defs/ThreadId"
        }
      },
      "required": ["threadId"]
    },
    "EndTurnResponse": {
      "type": "null"
    },
    "FileVersion": {
      "type": "integer",
      "format": "uint64",
      "minimum": 0
    },
    "GetThreadEntriesParams": {
      "type": "object",
      "properties": {
        "threadId": {
          "$ref": "#/$defs/ThreadId"
        }
      },
      "required": ["threadId"]
    },
    "GetThreadEntriesResponse": {
      "type": "object",
      "properties": {
        "entries": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/ThreadEntry"
          }
        }
      },
      "required": ["entries"]
    },
    "GetThreadsParams": {
      "type": "null"
    },
    "GetThreadsResponse": {
      "type": "object",
      "properties": {
        "threads": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/ThreadMetadata"
          }
        }
      },
      "required": ["threads"]
    },
    "GlobSearchParams": {
      "type": "object",
      "properties": {
        "pattern": {
          "type": "string"
        },
        "threadId": {
          "$ref": "#/$defs/ThreadId"
        }
      },
      "required": ["threadId", "pattern"]
    },
    "GlobSearchResponse": {
      "type": "object",
      "properties": {
        "matches": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      },
      "required": ["matches"]
    },
    "Message": {
      "type": "object",
      "properties": {
        "chunks": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/MessageChunk"
          }
        },
        "role": {
          "$ref": "#/$defs/Role"
        }
      },
      "required": ["role", "chunks"]
    },
    "MessageChunk": {
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "text"
            },
            "chunk": {
              "type": "string"
            }
          },
          "required": ["type", "chunk"]
        }
      ]
    },
    "OpenThreadParams": {
      "type": "object",
      "properties": {
        "threadId": {
          "$ref": "#/$defs/ThreadId"
        }
      },
      "required": ["threadId"]
    },
    "OpenThreadResponse": {
      "type": "null"
    },
    "ReadBinaryFileParams": {
      "type": "object",
      "properties": {
        "byteLimit": {
          "type": ["integer", "null"],
          "format": "uint64",
          "minimum": 0
        },
        "byteOffset": {
          "type": ["integer", "null"],
          "format": "uint64",
          "minimum": 0
        },
        "path": {
          "type": "string"
        },
        "threadId": {
          "$ref": "#/$defs/ThreadId"
        }
      },
      "required": ["threadId", "path"]
    },
    "ReadBinaryFileResponse": {
      "type": "object",
      "properties": {
        "content": {
          "type": "string"
        },
        "version": {
          "$ref": "#/$defs/FileVersion"
        }
      },
      "required": ["version", "content"]
    },
    "ReadTextFileParams": {
      "type": "object",
      "properties": {
        "lineLimit": {
          "type": ["integer", "null"],
          "format": "uint32",
          "minimum": 0
        },
        "lineOffset": {
          "type": ["integer", "null"],
          "format": "uint32",
          "minimum": 0
        },
        "path": {
          "type": "string"
        },
        "threadId": {
          "$ref": "#/$defs/ThreadId"
        }
      },
      "required": ["threadId", "path"]
    },
    "ReadTextFileResponse": {
      "type": "object",
      "properties": {
        "content": {
          "type": "string"
        },
        "version": {
          "$ref": "#/$defs/FileVersion"
        }
      },
      "required": ["version", "content"]
    },
    "Role": {
      "type": "string",
      "enum": ["user", "assistant"]
    },
    "SendMessageParams": {
      "type": "object",
      "properties": {
        "message": {
          "$ref": "#/$defs/Message"
        },
        "threadId": {
          "$ref": "#/$defs/ThreadId"
        }
      },
      "required": ["threadId", "message"]
    },
    "SendMessageResponse": {
      "type": "null"
    },
    "StatParams": {
      "type": "object",
      "properties": {
        "path": {
          "type": "string"
        },
        "threadId": {
          "$ref": "#/$defs/ThreadId"
        }
      },
      "required": ["threadId", "path"]
    },
    "StatResponse": {
      "type": "object",
      "properties": {
        "exists": {
          "type": "boolean"
        },
        "isDirectory": {
          "type": "boolean"
        }
      },
      "required": ["exists", "isDirectory"]
    },
    "StreamMessageChunkParams": {
      "type": "object",
      "properties": {
        "chunk": {
          "$ref": "#/$defs/MessageChunk"
        },
        "threadId": {
          "$ref": "#/$defs/ThreadId"
        }
      },
      "required": ["threadId", "chunk"]
    },
    "StreamMessageChunkResponse": {
      "type": "null"
    },
    "ThreadEntry": {
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "message"
            },
            "chunks": {
              "type": "array",
              "items": {
                "$ref": "#/$defs/MessageChunk"
              }
            },
            "role": {
              "$ref": "#/$defs/Role"
            }
          },
          "required": ["type", "role", "chunks"]
        },
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "readFile"
            },
            "content": {
              "type": "string"
            },
            "path": {
              "type": "string"
            }
          },
          "required": ["type", "path", "content"]
        }
      ]
    },
    "ThreadId": {
      "type": "string"
    },
    "ThreadMetadata": {
      "type": "object",
      "properties": {
        "title": {
          "type": "string"
        },
        "id": {
          "$ref": "#/$defs/ThreadId"
        },
        "modifiedAt": {
          "type": "string",
          "format": "date-time"
        }
      },
      "required": ["id", "title", "modifiedAt"]
    }
  }
}
