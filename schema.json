{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "anyOf": [
    {
      "$ref": "#/$defs/AnyClientRequest"
    },
    {
      "$ref": "#/$defs/AnyClientResult"
    },
    {
      "$ref": "#/$defs/AnyAgentRequest"
    },
    {
      "$ref": "#/$defs/AnyAgentResult"
    }
  ],
  "$defs": {
    "AnyAgentRequest": {
      "anyOf": [
        {
          "$ref": "#/$defs/GetThreadsParams"
        },
        {
          "$ref": "#/$defs/CreateThreadParams"
        },
        {
          "$ref": "#/$defs/OpenThreadParams"
        },
        {
          "$ref": "#/$defs/GetThreadEntriesParams"
        },
        {
          "$ref": "#/$defs/SendMessageParams"
        }
      ]
    },
    "AnyAgentResult": {
      "anyOf": [
        {
          "$ref": "#/$defs/GetThreadsResponse"
        },
        {
          "$ref": "#/$defs/CreateThreadResponse"
        },
        {
          "$ref": "#/$defs/OpenThreadResponse"
        },
        {
          "$ref": "#/$defs/GetThreadEntriesResponse"
        },
        {
          "$ref": "#/$defs/SendMessageResponse"
        }
      ]
    },
    "AnyClientRequest": {
      "anyOf": [
        {
          "$ref": "#/$defs/StreamMessageChunkParams"
        },
        {
          "$ref": "#/$defs/ReadFileParams"
        },
        {
          "$ref": "#/$defs/GlobSearchParams"
        },
        {
          "$ref": "#/$defs/EndTurnParams"
        }
      ]
    },
    "AnyClientResult": {
      "anyOf": [
        {
          "$ref": "#/$defs/StreamMessageChunkResponse"
        },
        {
          "$ref": "#/$defs/ReadFileResponse"
        },
        {
          "$ref": "#/$defs/GlobSearchResponse"
        },
        {
          "$ref": "#/$defs/EndTurnResponse"
        }
      ]
    },
    "CreateThreadParams": {
      "type": "null"
    },
    "CreateThreadResponse": {
      "type": "object",
      "properties": {
        "thread_id": {
          "$ref": "#/$defs/ThreadId"
        }
      },
      "required": ["thread_id"]
    },
    "EndTurnParams": {
      "type": "object",
      "properties": {
        "thread_id": {
          "$ref": "#/$defs/ThreadId"
        }
      },
      "required": ["thread_id"]
    },
    "EndTurnResponse": {
      "type": "null"
    },
    "FileVersion": {
      "type": "integer",
      "format": "uint64",
      "minimum": 0
    },
    "GetThreadEntriesParams": {
      "type": "object",
      "properties": {
        "thread_id": {
          "$ref": "#/$defs/ThreadId"
        }
      },
      "required": ["thread_id"]
    },
    "GetThreadEntriesResponse": {
      "type": "object",
      "properties": {
        "entries": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/ThreadEntry"
          }
        }
      },
      "required": ["entries"]
    },
    "GetThreadsParams": {
      "type": "null"
    },
    "GetThreadsResponse": {
      "type": "object",
      "properties": {
        "threads": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/ThreadMetadata"
          }
        }
      },
      "required": ["threads"]
    },
    "GlobSearchParams": {
      "type": "object",
      "properties": {
        "pattern": {
          "type": "string"
        },
        "thread_id": {
          "$ref": "#/$defs/ThreadId"
        }
      },
      "required": ["thread_id", "pattern"]
    },
    "GlobSearchResponse": {
      "type": "object",
      "properties": {
        "matches": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      },
      "required": ["matches"]
    },
    "Message": {
      "type": "object",
      "properties": {
        "chunks": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/MessageChunk"
          }
        },
        "role": {
          "$ref": "#/$defs/Role"
        }
      },
      "required": ["role", "chunks"]
    },
    "MessageChunk": {
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "text"
            },
            "chunk": {
              "type": "string"
            }
          },
          "required": ["type", "chunk"]
        }
      ]
    },
    "OpenThreadParams": {
      "type": "object",
      "properties": {
        "thread_id": {
          "$ref": "#/$defs/ThreadId"
        }
      },
      "required": ["thread_id"]
    },
    "OpenThreadResponse": {
      "type": "null"
    },
    "ReadFileParams": {
      "type": "object",
      "properties": {
        "path": {
          "type": "string"
        },
        "thread_id": {
          "$ref": "#/$defs/ThreadId"
        }
      },
      "required": ["thread_id", "path"]
    },
    "ReadFileResponse": {
      "type": "object",
      "properties": {
        "content": {
          "type": "string"
        },
        "version": {
          "$ref": "#/$defs/FileVersion"
        }
      },
      "required": ["version", "content"]
    },
    "Role": {
      "type": "string",
      "enum": ["user", "assistant"]
    },
    "SendMessageParams": {
      "type": "object",
      "properties": {
        "message": {
          "$ref": "#/$defs/Message"
        },
        "thread_id": {
          "$ref": "#/$defs/ThreadId"
        }
      },
      "required": ["thread_id", "message"]
    },
    "SendMessageResponse": {
      "type": "null"
    },
    "StreamMessageChunkParams": {
      "type": "object",
      "properties": {
        "chunk": {
          "$ref": "#/$defs/MessageChunk"
        },
        "thread_id": {
          "$ref": "#/$defs/ThreadId"
        }
      },
      "required": ["thread_id", "chunk"]
    },
    "StreamMessageChunkResponse": {
      "type": "null"
    },
    "ThreadEntry": {
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "message"
            },
            "chunks": {
              "type": "array",
              "items": {
                "$ref": "#/$defs/MessageChunk"
              }
            },
            "role": {
              "$ref": "#/$defs/Role"
            }
          },
          "required": ["type", "role", "chunks"]
        },
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "read_file"
            },
            "content": {
              "type": "string"
            },
            "path": {
              "type": "string"
            }
          },
          "required": ["type", "path", "content"]
        }
      ]
    },
    "ThreadId": {
      "type": "string"
    },
    "ThreadMetadata": {
      "type": "object",
      "properties": {
        "title": {
          "type": "string"
        },
        "id": {
          "$ref": "#/$defs/ThreadId"
        },
        "modified_at": {
          "type": "string",
          "format": "date-time"
        }
      },
      "required": ["id", "title", "modified_at"]
    }
  }
}
