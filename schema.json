{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "anyOf": [
    {
      "$ref": "#/$defs/AnyClientRequest"
    },
    {
      "$ref": "#/$defs/AnyClientResult"
    },
    {
      "$ref": "#/$defs/AnyAgentRequest"
    },
    {
      "$ref": "#/$defs/AnyAgentResult"
    }
  ],
  "$defs": {
    "AnyAgentRequest": {
      "anyOf": [
        {
          "$ref": "#/$defs/InitializeParams"
        },
        {
          "$ref": "#/$defs/AuthenticateParams"
        },
        {
          "$ref": "#/$defs/GetThreadsParams"
        },
        {
          "$ref": "#/$defs/CreateThreadParams"
        },
        {
          "$ref": "#/$defs/OpenThreadParams"
        },
        {
          "$ref": "#/$defs/GetThreadEntriesParams"
        },
        {
          "$ref": "#/$defs/SendMessageParams"
        }
      ]
    },
    "AnyAgentResult": {
      "anyOf": [
        {
          "$ref": "#/$defs/InitializeResponse"
        },
        {
          "$ref": "#/$defs/AuthenticateResponse"
        },
        {
          "$ref": "#/$defs/GetThreadsResponse"
        },
        {
          "$ref": "#/$defs/CreateThreadResponse"
        },
        {
          "$ref": "#/$defs/OpenThreadResponse"
        },
        {
          "$ref": "#/$defs/GetThreadEntriesResponse"
        },
        {
          "$ref": "#/$defs/SendMessageResponse"
        }
      ]
    },
    "AnyClientRequest": {
      "anyOf": [
        {
          "$ref": "#/$defs/StreamMessageChunkParams"
        },
        {
          "$ref": "#/$defs/ReadTextFileParams"
        },
        {
          "$ref": "#/$defs/ReadBinaryFileParams"
        },
        {
          "$ref": "#/$defs/StatParams"
        },
        {
          "$ref": "#/$defs/GlobSearchParams"
        },
        {
          "$ref": "#/$defs/RequestToolCallConfirmationParams"
        },
        {
          "$ref": "#/$defs/PushToolCallParams"
        },
        {
          "$ref": "#/$defs/UpdateToolCallParams"
        }
      ]
    },
    "AnyClientResult": {
      "anyOf": [
        {
          "$ref": "#/$defs/StreamMessageChunkResponse"
        },
        {
          "$ref": "#/$defs/ReadTextFileResponse"
        },
        {
          "$ref": "#/$defs/ReadBinaryFileResponse"
        },
        {
          "$ref": "#/$defs/StatResponse"
        },
        {
          "$ref": "#/$defs/GlobSearchResponse"
        },
        {
          "$ref": "#/$defs/RequestToolCallConfirmationResponse"
        },
        {
          "$ref": "#/$defs/PushToolCallResponse"
        },
        {
          "$ref": "#/$defs/UpdateToolCallResponse"
        }
      ]
    },
    "AuthenticateParams": {
      "type": "null"
    },
    "AuthenticateResponse": {
      "type": "null"
    },
    "CreateThreadParams": {
      "type": "null"
    },
    "CreateThreadResponse": {
      "type": "object",
      "properties": {
        "threadId": {
          "$ref": "#/$defs/ThreadId"
        }
      },
      "required": ["threadId"]
    },
    "FileVersion": {
      "type": "integer",
      "format": "uint64",
      "minimum": 0
    },
    "GetThreadEntriesParams": {
      "type": "object",
      "properties": {
        "threadId": {
          "$ref": "#/$defs/ThreadId"
        }
      },
      "required": ["threadId"]
    },
    "GetThreadEntriesResponse": {
      "type": "object",
      "properties": {
        "entries": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/ThreadEntry"
          }
        }
      },
      "required": ["entries"]
    },
    "GetThreadsParams": {
      "type": "null"
    },
    "GetThreadsResponse": {
      "type": "object",
      "properties": {
        "threads": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/ThreadMetadata"
          }
        }
      },
      "required": ["threads"]
    },
    "GlobSearchParams": {
      "type": "object",
      "properties": {
        "pattern": {
          "type": "string"
        },
        "threadId": {
          "$ref": "#/$defs/ThreadId"
        }
      },
      "required": ["threadId", "pattern"]
    },
    "GlobSearchResponse": {
      "type": "object",
      "properties": {
        "matches": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      },
      "required": ["matches"]
    },
    "Icon": {
      "type": "string",
      "enum": [
        "fileSearch",
        "folder",
        "globe",
        "hammer",
        "lightBulb",
        "pencil",
        "regex",
        "terminal"
      ]
    },
    "InitializeParams": {
      "type": "null"
    },
    "InitializeResponse": {
      "type": "object",
      "properties": {
        "isAuthenticated": {
          "type": "boolean"
        }
      },
      "required": ["isAuthenticated"]
    },
    "Message": {
      "type": "object",
      "properties": {
        "chunks": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/MessageChunk"
          }
        },
        "role": {
          "$ref": "#/$defs/Role"
        }
      },
      "required": ["role", "chunks"]
    },
    "MessageChunk": {
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "text"
            },
            "chunk": {
              "type": "string"
            }
          },
          "required": ["type", "chunk"]
        }
      ]
    },
    "OpenThreadParams": {
      "type": "object",
      "properties": {
        "threadId": {
          "$ref": "#/$defs/ThreadId"
        }
      },
      "required": ["threadId"]
    },
    "OpenThreadResponse": {
      "type": "null"
    },
    "PushToolCallParams": {
      "type": "object",
      "properties": {
        "icon": {
          "$ref": "#/$defs/Icon"
        },
        "label": {
          "type": "string"
        },
        "threadId": {
          "$ref": "#/$defs/ThreadId"
        }
      },
      "required": ["threadId", "label", "icon"]
    },
    "PushToolCallResponse": {
      "type": "object",
      "properties": {
        "id": {
          "$ref": "#/$defs/ToolCallId"
        }
      },
      "required": ["id"]
    },
    "ReadBinaryFileParams": {
      "type": "object",
      "properties": {
        "byteLimit": {
          "type": ["integer", "null"],
          "format": "uint64",
          "minimum": 0
        },
        "byteOffset": {
          "type": ["integer", "null"],
          "format": "uint64",
          "minimum": 0
        },
        "path": {
          "type": "string"
        },
        "threadId": {
          "$ref": "#/$defs/ThreadId"
        }
      },
      "required": ["threadId", "path"]
    },
    "ReadBinaryFileResponse": {
      "type": "object",
      "properties": {
        "content": {
          "type": "string"
        },
        "version": {
          "$ref": "#/$defs/FileVersion"
        }
      },
      "required": ["version", "content"]
    },
    "ReadTextFileParams": {
      "type": "object",
      "properties": {
        "lineLimit": {
          "type": ["integer", "null"],
          "format": "uint32",
          "minimum": 0
        },
        "lineOffset": {
          "type": ["integer", "null"],
          "format": "uint32",
          "minimum": 0
        },
        "path": {
          "type": "string"
        },
        "threadId": {
          "$ref": "#/$defs/ThreadId"
        }
      },
      "required": ["threadId", "path"]
    },
    "ReadTextFileResponse": {
      "type": "object",
      "properties": {
        "content": {
          "type": "string"
        },
        "version": {
          "$ref": "#/$defs/FileVersion"
        }
      },
      "required": ["version", "content"]
    },
    "RequestToolCallConfirmationParams": {
      "type": "object",
      "properties": {
        "confirmation": {
          "$ref": "#/$defs/ToolCallConfirmation"
        },
        "icon": {
          "$ref": "#/$defs/Icon"
        },
        "label": {
          "type": "string"
        },
        "threadId": {
          "$ref": "#/$defs/ThreadId"
        }
      },
      "required": ["threadId", "label", "icon", "confirmation"]
    },
    "RequestToolCallConfirmationResponse": {
      "type": "object",
      "properties": {
        "id": {
          "$ref": "#/$defs/ToolCallId"
        },
        "outcome": {
          "$ref": "#/$defs/ToolCallConfirmationOutcome"
        }
      },
      "required": ["id", "outcome"]
    },
    "Role": {
      "type": "string",
      "enum": ["user", "assistant"]
    },
    "SendMessageParams": {
      "type": "object",
      "properties": {
        "message": {
          "$ref": "#/$defs/Message"
        },
        "threadId": {
          "$ref": "#/$defs/ThreadId"
        }
      },
      "required": ["threadId", "message"]
    },
    "SendMessageResponse": {
      "type": "null"
    },
    "StatParams": {
      "type": "object",
      "properties": {
        "path": {
          "type": "string"
        },
        "threadId": {
          "$ref": "#/$defs/ThreadId"
        }
      },
      "required": ["threadId", "path"]
    },
    "StatResponse": {
      "type": "object",
      "properties": {
        "exists": {
          "type": "boolean"
        },
        "isDirectory": {
          "type": "boolean"
        },
        "size": {
          "type": "integer",
          "format": "uint64",
          "minimum": 0
        }
      },
      "required": ["exists", "isDirectory", "size"]
    },
    "StreamMessageChunkParams": {
      "type": "object",
      "properties": {
        "chunk": {
          "$ref": "#/$defs/MessageChunk"
        },
        "threadId": {
          "$ref": "#/$defs/ThreadId"
        }
      },
      "required": ["threadId", "chunk"]
    },
    "StreamMessageChunkResponse": {
      "type": "null"
    },
    "ThreadEntry": {
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "message"
            },
            "chunks": {
              "type": "array",
              "items": {
                "$ref": "#/$defs/MessageChunk"
              }
            },
            "role": {
              "$ref": "#/$defs/Role"
            }
          },
          "required": ["type", "role", "chunks"]
        }
      ]
    },
    "ThreadId": {
      "type": "string"
    },
    "ThreadMetadata": {
      "type": "object",
      "properties": {
        "title": {
          "type": "string"
        },
        "id": {
          "$ref": "#/$defs/ThreadId"
        },
        "modifiedAt": {
          "type": "string",
          "format": "date-time"
        }
      },
      "required": ["id", "title", "modifiedAt"]
    },
    "ToolCallConfirmation": {
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "description": {
              "type": ["string", "null"]
            },
            "type": {
              "type": "string",
              "const": "edit"
            },
            "newText": {
              "type": "string"
            },
            "oldText": {
              "type": ["string", "null"]
            },
            "path": {
              "type": "string"
            }
          },
          "required": ["type", "path", "oldText", "newText"]
        },
        {
          "type": "object",
          "properties": {
            "description": {
              "type": ["string", "null"]
            },
            "type": {
              "type": "string",
              "const": "execute"
            },
            "command": {
              "type": "string"
            },
            "rootCommand": {
              "type": "string"
            }
          },
          "required": ["type", "command", "rootCommand"]
        },
        {
          "type": "object",
          "properties": {
            "description": {
              "type": ["string", "null"]
            },
            "type": {
              "type": "string",
              "const": "mcp"
            },
            "serverName": {
              "type": "string"
            },
            "toolDisplayName": {
              "type": "string"
            },
            "toolName": {
              "type": "string"
            }
          },
          "required": ["type", "serverName", "toolName", "toolDisplayName"]
        },
        {
          "type": "object",
          "properties": {
            "description": {
              "type": ["string", "null"]
            },
            "type": {
              "type": "string",
              "const": "fetch"
            },
            "urls": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          },
          "required": ["type", "urls"]
        },
        {
          "type": "object",
          "properties": {
            "description": {
              "type": "string"
            },
            "type": {
              "type": "string",
              "const": "other"
            }
          },
          "required": ["type", "description"]
        }
      ]
    },
    "ToolCallConfirmationOutcome": {
      "type": "string",
      "enum": [
        "allow",
        "alwaysAllow",
        "alwaysAllowMcpServer",
        "alwaysAllowTool",
        "reject"
      ]
    },
    "ToolCallContent": {
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "markdown"
            },
            "markdown": {
              "type": "string"
            }
          },
          "required": ["type", "markdown"]
        },
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "diff"
            },
            "newText": {
              "type": "string"
            },
            "oldText": {
              "type": ["string", "null"]
            },
            "path": {
              "type": "string"
            }
          },
          "required": ["type", "path", "oldText", "newText"]
        }
      ]
    },
    "ToolCallId": {
      "type": "integer",
      "format": "uint64",
      "minimum": 0
    },
    "ToolCallStatus": {
      "type": "string",
      "enum": ["running", "finished", "error"]
    },
    "UpdateToolCallParams": {
      "type": "object",
      "properties": {
        "content": {
          "anyOf": [
            {
              "$ref": "#/$defs/ToolCallContent"
            },
            {
              "type": "null"
            }
          ]
        },
        "status": {
          "$ref": "#/$defs/ToolCallStatus"
        },
        "threadId": {
          "$ref": "#/$defs/ThreadId"
        },
        "toolCallId": {
          "$ref": "#/$defs/ToolCallId"
        }
      },
      "required": ["threadId", "toolCallId", "status", "content"]
    },
    "UpdateToolCallResponse": {
      "type": "null"
    }
  }
}
