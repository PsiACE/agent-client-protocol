{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "anyOf": [
    {
      "$ref": "#/$defs/AnyClientRequest"
    },
    {
      "$ref": "#/$defs/AnyClientResult"
    },
    {
      "$ref": "#/$defs/AnyAgentRequest"
    },
    {
      "$ref": "#/$defs/AnyAgentResult"
    }
  ],
  "$defs": {
    "AnyAgentRequest": {
      "anyOf": [
        {
          "$ref": "#/$defs/InitializeParams"
        },
        {
          "$ref": "#/$defs/AuthenticateParams"
        },
        {
          "$ref": "#/$defs/SendUserMessageParams"
        },
        {
          "$ref": "#/$defs/CancelSendMessageParams"
        }
      ]
    },
    "AnyAgentResult": {
      "anyOf": [
        {
          "$ref": "#/$defs/InitializeResponse"
        },
        {
          "$ref": "#/$defs/AuthenticateResponse"
        },
        {
          "$ref": "#/$defs/SendUserMessageResponse"
        },
        {
          "$ref": "#/$defs/CancelSendMessageResponse"
        }
      ]
    },
    "AnyClientRequest": {
      "anyOf": [
        {
          "$ref": "#/$defs/StreamAssistantMessageChunkParams"
        },
        {
          "$ref": "#/$defs/RequestToolCallConfirmationParams"
        },
        {
          "$ref": "#/$defs/PushToolCallParams"
        },
        {
          "$ref": "#/$defs/UpdateToolCallParams"
        }
      ]
    },
    "AnyClientResult": {
      "anyOf": [
        {
          "$ref": "#/$defs/StreamAssistantMessageChunkResponse"
        },
        {
          "$ref": "#/$defs/RequestToolCallConfirmationResponse"
        },
        {
          "$ref": "#/$defs/PushToolCallResponse"
        },
        {
          "$ref": "#/$defs/UpdateToolCallResponse"
        }
      ]
    },
    "AssistantMessageChunk": {
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "text"
            },
            "chunk": {
              "type": "string"
            }
          },
          "required": ["type", "chunk"]
        },
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "thought"
            },
            "chunk": {
              "type": "string"
            }
          },
          "required": ["type", "chunk"]
        }
      ]
    },
    "AuthenticateParams": {
      "type": "null"
    },
    "AuthenticateResponse": {
      "type": "null"
    },
    "CancelSendMessageParams": {
      "type": "null"
    },
    "CancelSendMessageResponse": {
      "type": "null"
    },
    "Icon": {
      "type": "string",
      "enum": [
        "fileSearch",
        "folder",
        "globe",
        "hammer",
        "lightBulb",
        "pencil",
        "regex",
        "terminal"
      ]
    },
    "InitializeParams": {
      "type": "null"
    },
    "InitializeResponse": {
      "type": "object",
      "properties": {
        "isAuthenticated": {
          "type": "boolean"
        }
      },
      "required": ["isAuthenticated"]
    },
    "PushToolCallParams": {
      "type": "object",
      "properties": {
        "content": {
          "anyOf": [
            {
              "$ref": "#/$defs/ToolCallContent"
            },
            {
              "type": "null"
            }
          ]
        },
        "icon": {
          "$ref": "#/$defs/Icon"
        },
        "label": {
          "type": "string"
        }
      },
      "required": ["label", "icon"]
    },
    "PushToolCallResponse": {
      "type": "object",
      "properties": {
        "id": {
          "$ref": "#/$defs/ToolCallId"
        }
      },
      "required": ["id"]
    },
    "RequestToolCallConfirmationParams": {
      "type": "object",
      "properties": {
        "confirmation": {
          "$ref": "#/$defs/ToolCallConfirmation"
        },
        "content": {
          "anyOf": [
            {
              "$ref": "#/$defs/ToolCallContent"
            },
            {
              "type": "null"
            }
          ]
        },
        "icon": {
          "$ref": "#/$defs/Icon"
        },
        "label": {
          "type": "string"
        }
      },
      "required": ["label", "icon", "confirmation"]
    },
    "RequestToolCallConfirmationResponse": {
      "type": "object",
      "properties": {
        "id": {
          "$ref": "#/$defs/ToolCallId"
        },
        "outcome": {
          "$ref": "#/$defs/ToolCallConfirmationOutcome"
        }
      },
      "required": ["id", "outcome"]
    },
    "SendUserMessageParams": {
      "type": "object",
      "properties": {
        "message": {
          "$ref": "#/$defs/UserMessage"
        }
      },
      "required": ["message"]
    },
    "SendUserMessageResponse": {
      "type": "null"
    },
    "StreamAssistantMessageChunkParams": {
      "type": "object",
      "properties": {
        "chunk": {
          "$ref": "#/$defs/AssistantMessageChunk"
        }
      },
      "required": ["chunk"]
    },
    "StreamAssistantMessageChunkResponse": {
      "type": "null"
    },
    "ToolCallConfirmation": {
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "description": {
              "type": ["string", "null"]
            },
            "type": {
              "type": "string",
              "const": "edit"
            }
          },
          "required": ["type"]
        },
        {
          "type": "object",
          "properties": {
            "description": {
              "type": ["string", "null"]
            },
            "type": {
              "type": "string",
              "const": "execute"
            },
            "command": {
              "type": "string"
            },
            "rootCommand": {
              "type": "string"
            }
          },
          "required": ["type", "command", "rootCommand"]
        },
        {
          "type": "object",
          "properties": {
            "description": {
              "type": ["string", "null"]
            },
            "type": {
              "type": "string",
              "const": "mcp"
            },
            "serverName": {
              "type": "string"
            },
            "toolDisplayName": {
              "type": "string"
            },
            "toolName": {
              "type": "string"
            }
          },
          "required": ["type", "serverName", "toolName", "toolDisplayName"]
        },
        {
          "type": "object",
          "properties": {
            "description": {
              "type": ["string", "null"]
            },
            "type": {
              "type": "string",
              "const": "fetch"
            },
            "urls": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          },
          "required": ["type", "urls"]
        },
        {
          "type": "object",
          "properties": {
            "description": {
              "type": "string"
            },
            "type": {
              "type": "string",
              "const": "other"
            }
          },
          "required": ["type", "description"]
        }
      ]
    },
    "ToolCallConfirmationOutcome": {
      "type": "string",
      "enum": [
        "allow",
        "alwaysAllow",
        "alwaysAllowMcpServer",
        "alwaysAllowTool",
        "reject",
        "cancel"
      ]
    },
    "ToolCallContent": {
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "markdown"
            },
            "markdown": {
              "type": "string"
            }
          },
          "required": ["type", "markdown"]
        },
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "diff"
            },
            "newText": {
              "type": "string"
            },
            "oldText": {
              "type": ["string", "null"]
            },
            "path": {
              "type": "string"
            }
          },
          "required": ["type", "path", "oldText", "newText"]
        }
      ]
    },
    "ToolCallId": {
      "type": "integer",
      "format": "uint64",
      "minimum": 0
    },
    "ToolCallStatus": {
      "type": "string",
      "enum": ["running", "finished", "error"]
    },
    "UpdateToolCallParams": {
      "type": "object",
      "properties": {
        "content": {
          "anyOf": [
            {
              "$ref": "#/$defs/ToolCallContent"
            },
            {
              "type": "null"
            }
          ]
        },
        "status": {
          "$ref": "#/$defs/ToolCallStatus"
        },
        "toolCallId": {
          "$ref": "#/$defs/ToolCallId"
        }
      },
      "required": ["toolCallId", "status", "content"]
    },
    "UpdateToolCallResponse": {
      "type": "null"
    },
    "UserMessage": {
      "type": "object",
      "properties": {
        "chunks": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/UserMessageChunk"
          }
        }
      },
      "required": ["chunks"]
    },
    "UserMessageChunk": {
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "text"
            },
            "chunk": {
              "type": "string"
            }
          },
          "required": ["type", "chunk"]
        },
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "path"
            },
            "path": {
              "type": "string"
            }
          },
          "required": ["type", "path"]
        }
      ]
    }
  }
}
